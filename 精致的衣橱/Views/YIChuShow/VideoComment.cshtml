@model IEnumerable<Models.VideoComment>
@*<script src="~/Scripts/jquery-3.1.1.min.js"></script>*@
@*<script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script>*@
@foreach (var c in Model)
{
    <p>评论</p>
        @c.Commentcotent   
        <button id="@c.VideoCommentID">回复</button>
    <div>
        @Html.Action("VideoCommentReply", new { commentid =@c.VideoCommentID })
    </div>
   <div style="visibility:hidden" id="vc">@c.VideoCommentID</div>
  <div style="visibility:hidden" id="v">@c.VideoID</div>
}
<textarea class="commentreply"></textarea>
<p id="demo">demo</p>
<script>
        //  $(function () {
        //    $(document).on('click', 'button', function () {   //评论回复
        //        var commentreply = $(".commentreply").val();
        //        var vcommentid = $(this).attr("id");
        //        var videoid = $("#v").text();
        //        $.ajax({
        //            type: "post",
        //            url: "/YiChuShow/VideoCommentReply",
        //            data: { "commentreply": commentreply ,"videocommentid":vcommentid},
        //                success: function (data) {
        //                    alert(data);
        //                    $.ajax({
        //                        type: "get",
        //                        url: "/YiChuShow/VideoComment",
        //                        data: { "videoid": videoid },
        //                        success: function (data) {
        //                            location.href = "/YiChuShow/VideoDetail/" + videoid
        //                        },
        //                        async: true
        //                    });
        //                },
        //                async: true
        //            });
        //    });
    //});
    //事件绑定
    function addEvent(obj,type,handle){
        try{ // Chrome、FireFox、Opera、Safari、IE9.0及其以上版本
            obj.addEventListener(type,handle,false);
             }catch(e){
                try{ // IE8.0及其以下版本
                   obj.attachEvent('on' + type,handle);
                    }catch(e){ // 早期浏览器
                         obj['on' + type] = handle;
                        }
               }
     }

    //ajax函数
    function ajax_method(url, data, method, success) {
        // 异步对象
        var ajax = new XMLHttpRequest();
        // get 跟post  需要分别写不同的代码
        if (method == 'get') {
            // get请求
            if (data) {
                // 如果有值
                url += '?';
                url += data;
            } else {
            }
            // 设置 方法 以及 url
            ajax.open(method, url);
            // send即可
            ajax.send();
        } else {
            // post请求
            // post请求 url 是不需要改变
            ajax.open(method, url);
            // 需要设置请求报文
            ajax.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            // 判断data send发送数据
            if (data) {
                // 如果有值 从send发送
                ajax.send(data);
            } else {
                // 木有值 直接发送即可
                ajax.send();
            }
        }
        // 注册事件
        ajax.onreadystatechange = function () {
            // 在事件中 获取数据 并修改界面显示
            if (ajax.readyState == 4 && ajax.status == 200) {
                // console.log(ajax.responseText);
                // 将 数据 让 外面可以使用
                // return ajax.responseText;
                // 当 onreadystatechange 调用时 说明 数据回来了
                // ajax.responseText;
                // 如果说 外面可以传入一个 function 作为参数 success
                success(ajax.responseText);
            }
        }
    }
    //评论
    var videoid = document.getElementById("v").innerText;
    var commentreply = document.getElementsByClassName("commentreply").value;
    function pinlun(){
        
        var vcommentid = this.attr("id");
       
        ajax_method("/YiChuShow/VideoCommentReply",{"commentreply": commentreply ,"videocommentid":vcommentid},post,alert("评论成功"))
    }
    addEvent(document.getElementById("demo"), "click", myAlert);
    addEvent(document.getElementsByName("button"), "click", myAlert)
    //addEvent(document.getElementsByTagName("button"), "click", pinlun)
    //addEvent(document.getElementsById(videoid), "click", myAlert)
    function myAlert() {
        alert("aaaaa")
    }
</script>



      
