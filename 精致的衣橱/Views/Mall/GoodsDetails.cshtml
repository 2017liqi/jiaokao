@model Models.Goods
@{

Layout = "~/Views/Shared/_LayoutDaohang.cshtml";


}
<style>
   

    ul {
        list-style: none;
    }

    .center {
        width: 1005px;
        height: 600px;
        margin-left: 360px;
        margin-top: 77px;
    }

    .pic img {
        width: 300px;
        height: 300px;
    }

    .details {
        width: 300px;
        height: 300px;
        margin-left: 330px;
        margin-top: -300px;
    }

    #price{
        font-size:24px;
         color:red;
    }
    #goodsid{
        visibility:hidden;
    }
    #s{

    }
    #tt{
        border-radius:4px;
        height:68px;
        width:515px;
        display:block;
        border:1px solid #c03f3c;
        max-width:515px;
        
    }
    
   
    .jiagou{
        display:inline-block;
        background:red;
        width:82px;
        height:34px;
        border-radius:4px;
        text-align:center;
        padding:7px;
        color:white;
        margin-top:7px;

    }
    .jiagou:hover{
        color:white;
        text-decoration:none;
    }
    .s{
        display:inline;
    }
    .btn1{
        width:82px;
        height:34px;
        
        margin-right:50px;
        margin-top:8px;
        border-radius:5px;
        
    }
    #pp{
        margin:auto 285px;
    }
    .nav-r{
        margin-top:-58px;
    }
     ul li{
            /*display:inline;*/
            list-style:none;
        }
        #toTop {
            position: fixed;
            width: 50px;
            height: 50px;
            right: 0;
            bottom: 0;
            display: none;
        }
</style>
<script src="~/Scripts/main.js"></script>
<link href="~/Content/main.css" rel="stylesheet" />
<link href="~/Content/bootstrap.min.css" rel="stylesheet" />
<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<script src="~/Scripts/bootstrap.min.js"></script>

<div class="center" id="center">
    <div class="pic">
        <img src="~/Images/GoodsImages/@Model.GoodsImage" />
        <div class="mask"></div>
    </div>
   

    <div class="details">
        @*@using (Html.BeginForm("Cart", "Mall", FormMethod.Post))
        {*@
            <h3>@Model.Name</h3>
            <div style="width:100%;height:40px;background-color:lavenderblush;">
                <span style="color:darkgoldenrod;font-size:18px;height:40px;line-height:40px;display:inline-block;">价格：</span>
                <span>￥@Model.Unitprice</span>
               
                <input type="hidden" name="price" value="@Model.Unitprice" />
                <input type="hidden" name="goods" value="@Model.GoodsID" />
                @Html.Hidden("Price", Model.Unitprice);
                <input type="hidden" value="@Model.Unitprice" name="unitprice" />
               
            </div>
            <h4 style="color:dimgray">江浙沪顺丰包邮</h4>
            <div style="height:40px;width:100%;margin-top:20px;">
                <span>数量：</span>
                @Html.Hidden("GoodsID", Model.GoodsID);
                <input type="number" min="1" max="@Model.Amount" value="1" style="width:80px;" name="number" id="s" />

                <div style="margin-top:10px;">
                    <span>库存：</span>
                    <span id="kucun">@Model.Amount</span>
                  </div>
                    <div style="margin-top:10px;">
                        <div style="margin-top:56px;">
                            <div align="left" style="float:left;padding-left:17px;">
                                <button  class="jiagou">加购物车</button>
                                @*href="@Url.Action("Cart","Mall",new {GoodsID=Model.GoodsID })"*@
                            </div>
                            <div align="right">
                                <button type="button" style="background-color:red; color:white;"  data-toggle="modal" data-target="#myModal1" class="btn1">直接购买</button>
                            </div>
                        </div>
                            <div class="modal fade" id="myModal1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true" style="margin-top:50px;">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            @*<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                                &times;
                                            </button>*@
                                            <h4 class="modal-title" id="myModalLabel1">
                                                请填写信息：
                                            </h4>
                                        </div>
                                        <div class="modal-body">
                        <label for="Ord_Name">收件人：</label>
                        <input id="Name" name="Name" type="text" />
                        <br />
                        <label for="Ord_Add">地&nbsp;&nbsp;&nbsp;址：</label>
                        <input id="Address" name="Address" type="text" />
                        <br />
                        <label for="Ord_Tel">电&nbsp;&nbsp;&nbsp;话：</label>
                        <input id="Tel" name="Tel" type="text" />
                        
                        </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">
                                    关闭
                                </button>
                                <button type="button" id="Sub" class="btn btn-primary">
                                    提交
                                </button>
                            </div>
                        </div>
                                            </div>
                                        </div>
                                    </div>
                                
                            </div>

            
       @*}*@           
     </div>
</div>
@*<hr />*@

<div style="margin-left:282px;margin-top:-100px;">
    <h2>商品详情</h2>
    <img src="~/Images/ta1/@Model.GoodsDetails" />
</div>
<hr />
<div id="pp">
    <div id="p1">

        <input name="pingluntextarea" style="resize:none;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;height:68px;width:623px;display:block;border:1px solid #c03f3c;" value="" class="t">
        <button class="btn1">提交</button>
    </div>
    <div id="p2">
        @Html.Action("Comment", "Mall", new { goodsid = Model.GoodsID })
    </div>
</div>
<div class="container">
    <div class="container-fluid text-center">
        <div class="box">
            <hr class="line">
            <span class="txt">End</span>
            <hr class="line">
        </div>
    </div>
    <div class="row">
        <div class="col-md-3">
            <ul>
                <li>
                    <b>购物指南</b>
                    <p style="margin-top:20px"><a href="#" style="color:black">购物流程</a></p>
                    <p><a href="#" style="color:black">会员介绍</a></p>
                    <p><a href="#" style="color:black">常见问题</a></p>
                </li>
            </ul>
        </div>
        <div class="col-md-3">
            <ul>
                <li>
                    <b>配送方式</b>
                    <p style="margin-top:20px"><a href="#" style="color:black">上门自提</a></p>
                    <p><a href="#" style="color:black">配送服务查询</a></p>
                    <p><a href="#" style="color:black">海外配送</a></p>
                    <p><a href="#" style="color:black">211限时达</a></p>
                </li>
            </ul>
        </div>
        <div class="col-md-3">
            <ul>
                <li>
                    <b>支付方式</b>
                    <p style="margin-top:20px"><span>货到付款</span></p>
                    <p><a href="#" style="color:black">在线支付</a></p>
                    <p><a href="#" style="color:black">分期付款</a></p>
                    <p><a href="#" style="color:black">邮局汇款</a></p>
                </li>

            </ul>
        </div>
        <div class="col-md-3">
            <ul>
                <li><b>联系方式</b></li>
                <li style="margin-top:20px">
                    电话:0791-2289-990
                </li>

            </ul>

        </div>
    </div>
</div>
<div id="toTop">
    <img src="~/iconfont/回到顶部.png" style="width:50px;height:50px;" title="回到顶部" />
</div>











<script type="text/javascript" language="javascript">
    $(function (){
        var uname = $("#Name");

        var add = $("#Address");
        var tel = $("#Tel")


        var price = $("input[name='unitprice']");
        var num = $("input[name='number']");
        var total =parseInt(price.val()) * parseInt(num.val());

        var GoodsID = $("input[name='goods']");

        $("#Sub").on("click", function () {

            $.ajax({
                type: 'post',

                url: "/Mall/DirectBuy",
                data: {
                    "total": total,
                    "uname": uname.val(),
                    "tel": tel.val(),
                    "address":add.val(),
                    "goodsid": GoodsID.val(),
                    "num":num.val()


                },

                success: function (data) {

                    alert(data.message);
                    location.href = "/Mall/Order";

                },
                error: function () {
                    alert("购物失败");
                }
            });
        });
        var text = $(".t");
        //var text = "dsfsdf";

        $(".btn1").on("click", function () {

            $.ajax({
                type: 'post',

                url: "/Mall/Comment",
                data: {
                    "pinglun":text.val(),
                    "goodsid":@Model.GoodsID,
                },



                success: function (data) {
                    //alert(data.message);
                    $.ajax({
                        type:'get',

                        url: "/Mall/Comment",
                        data: {
                            "goodsid":@Model.GoodsID,
                        },
                        success: function (data) {
                            $('#p2').html(data);
                        },
                        //async: true

                    });

                },
                

            });
        });
        var num = $("input[name='number']");
        $(".jiagou").on("click",function(){
            $.ajax({
                type: 'post',

                url: "/Mall/Cart",
                data: {
                    "GoodsID":@Model.GoodsID,
                    "Count":num.val()
                },
                success:function(data){
                    
                    location.href="/Mall/Cart"
                },

            })

        })
        $(window).scroll(function () {
            var height = $(document).scrollTop();
            if (height != 0) {
                $("#toTop").show();
            }
            else
                $("#toTop").hide();
        })
        $("#toTop").click(function () {
            scrollTo(0, 0);
        })
    })
</script>