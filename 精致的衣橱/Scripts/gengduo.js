!function (e) { var t = {}; function n(a) { if (t[a]) return t[a].exports; var i = t[a] = { i: a, l: !1, exports: {} }; return e[a].call(i.exports, i, i.exports, n), i.l = !0, i.exports } n.m = e, n.c = t, n.d = function (e, t, a) { n.o(e, t) || Object.defineProperty(e, t, { enumerable: !0, get: a }) }, n.r = function (e) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 }) }, n.t = function (e, t) { if (1 & t && (e = n(e)), 8 & t) return e; if (4 & t && "object" == typeof e && e && e.__esModule) return e; var a = Object.create(null); if (n.r(a), Object.defineProperty(a, "default", { enumerable: !0, value: e }), 2 & t && "string" != typeof e) for (var i in e) n.d(a, i, function (t) { return e[t] }.bind(null, i)); return a }, n.n = function (e) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return n.d(t, "a", t), t }, n.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, n.p = "/", n(n.s = 42) }({ 1: function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.BucketSuffix = t.url = t.time = t.login = t.dom = void 0; var a = s(n(4)), i = s(n(5)), o = s(n(2)), r = s(n(6)); function s(e) { if (e && e.__esModule) return e; var t = {}; if (null != e) for (var n in e) Object.prototype.hasOwnProperty.call(e, n) && (t[n] = e[n]); return t.default = e, t } t.dom = a, t.login = i, t.time = o, t.url = r, t.BucketSuffix = "huabanimg.com" }, 2: function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.getTime = function (e, t, n) { var a = void 0, i = void 0; if (2 === t) { var o = 0; e && e.map(function (e) { e.duration ? o += e.duration : o += Math.floor((+new Date(e.endAt) - +new Date(e.startAt)) / 1e3) }), a = Math.floor(o / 3600), i = Math.floor(o / 60) % 60 } else a = Math.floor(n / 60), i = n % 60; return (a > 0 ? a + " 小时" : "") + (i > 0 ? (a > 0 ? " " : "") + i + " 分钟" : "") } }, 3: function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.showMessage = t.Message = void 0; var a = function (e) { return e && e.__esModule ? e : { default: e } }(n(9)); a.default.success = function (e) { var t = new a.default({ content: e, duration: 2e3, type: "success" }); t.render(), t.componentDidMount() }, a.default.warning = function (e) { var t = new a.default({ content: e, duration: 2e3, type: "warning" }); t.render(), t.componentDidMount() }, a.default.error = function (e) { var t = new a.default({ content: e, duration: 2e3, type: "error" }); t.render(), t.componentDidMount() }, t.default = a.default, t.Message = a.default, t.showMessage = function (e) { var t = e.content, n = e.duration, i = e.type, o = new a.default({ content: t, duration: n, type: i }); o.render(), o.componentDidMount() } }, 4: function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.createSeriesMenuItem = t.createSingleLiveAbstract = t.handleLoading = t.htmlToElement = void 0; var a = n(2); function i(e) { var t = document.createElement("template"); return e = e.trim(), t.innerHTML = e, t.content.firstChild } var o = function (e) { for (var t = function (t) { var n = e[t], a = new Image; a.src = n.dataset.src, a.onload = function () { n && (n.querySelector(".la-img").style.backgroundImage = "url(" + a.src + ")", n.classList.remove("loading")) } }, n = 0; n < e.length; n++) t(n) }, r = function (e) { var t = e.live, n = 1 === t.banner.v ? t.banner.imgPast : t.banner.courseCover, o = n.url ? n.url : "", r = new Date(t.startAt), s = new Date(t.endAt), c = Math.abs(s - r) / 6e4; return c = (0, a.getTime)(t.medias, t.type, c), i("\n    <div class='live-abstract loading' data-id='" + t.id + "' data-src='" + o + "'>\n      <a class='la-img' href='/live/" + t.id + "' target='_blank'></a>\n      <a href='/live/" + t.id + "' target='_blank'>\n        <h2 class='la-title'>" + t.name + "</h2>\n        <h2 class='la-title'>" + t.subtitle + "</h2>\n      </a>\n      <p class='la-category'>\n        <span class='price'>¥ " + t.price + "</span>\n        <span class='category-tag'>" + t.category.name + "</span>\n      </p>\n      <p class='la-anchor-name'>" + t.anchor.name + "</p>\n      <p class='la-anchor-title'>" + t.anchor.title + "</p>\n      <div class='la-bottom'><div class='la-bottom-item'><span class='la-time'>" + c + "</span></div><div class='la-bottom-item'><a class='la-rating' href='/live/" + t.id + "/rating' target='_blank'>" + (0 === t.score ? "暂无评分" : t.score.toFixed(1) + "/5.0") + "</a></div>\n      </div>\n    </div>\n  ") }, s = function (e, t, n, a, o) { var r = "", s = "", c = "", l = ""; if (0 !== t || n) switch (e.status) { case 1: r = "future"; break; case 2: r = "being current", l = "http://play.huaban.com/watch/" + o + "?whole"; break; case 3: r = "generating"; break; case 4: r = "recorded", l = "http://play.huaban.com/watch/" + (s = e.activityId) + "?whole&video=" + (c = e.mediaId) } else switch (e.status) { case 1: r = "future"; break; case 3: r = "generating"; break; case 4: r = "recorded current", l = "http://play.huaban.com/watch/" + (s = e.activityId) + "?whole&video=" + (c = e.mediaId) } return i("\n    <li class='" + r + "' data-a='" + s + "' data-m='" + c + "' data-src='" + l + "'>\n      <span class='order'>" + (t < 9 ? "0" + (t + 1) : t + 1) + "</span>\n      <span class='text' style='width: " + a + "px'>" + e.title + "</span>\n      <span class='time'>" + function (e) { if (2 === e.status) return "直播中"; if (3 === e.status) return "生成中"; var t = new Date(e.startAt), n = new Date(e.endAt); if (1 === e.status) { var a = t.getMonth() + 1, i = t.getDate(); return (a < 10 ? "0" + a : a) + "/" + (i < 10 ? "0" + i : i) } var o = e.duration ? e.duration : Math.floor(Math.abs(n - t) / 1e3), r = Math.floor(o / 60), s = o % 60; return (r < 10 ? "0" + r : "" + r) + ":" + (s < 10 ? "0" + s : "" + s) }(e) + "</span>\n    </li>\n  ") }; t.default = { htmlToElement: i, handleLoading: o, createSingleLiveAbstract: r, createSeriesMenuItem: s }, t.htmlToElement = i, t.handleLoading = o, t.createSingleLiveAbstract = r, t.createSeriesMenuItem = s }, 42: function (e, t, n) { "use strict"; var a = n(1), i = n(3), o = a.dom.htmlToElement, r = a.dom.handleLoading, s = a.dom.createSingleLiveAbstract, c = document.querySelector("#past-lives-more div"), l = document.getElementById("past-lives"), d = document.getElementById("past-lives-tpl"), u = d.content.lastChild.dataset.id, v = !1; r(l.querySelectorAll(".loading")), c.addEventListener("click", function e() { if (d.content.children.length < 9 && !v) d.content.children.length % 3 == 1 && (d.content.appendChild(o('<div class="live-abstract hidden"></div>')), d.content.appendChild(o('<div class="live-abstract hidden"></div>'))), d.content.children.length % 3 == 2 && d.content.appendChild(o('<div class="live-abstract hidden"></div>')), l.appendChild(d.content), r(l.querySelectorAll(".loading")), c.firstChild.innerHTML = "没有更多了", c.removeEventListener("click", e); else { l.appendChild(d.content), r(l.querySelectorAll(".loading")); var t = new XMLHttpRequest; t.open("GET", "/api/v1/lives?limit=9&max=" + u), t.onload = function () { if (t.status >= 200 && t.status < 300) { var n = JSON.parse(t.response), a = document.createDocumentFragment(); n.map(function (e) { a.append(s({ isPaid: !1, live: e })) }), d.content.appendChild(a), d.content.lastChild && (u = d.content.lastChild.dataset.id), v && (v = !1, e()) } t.status >= 400 && (v = !0, (0, i.showMessage)({ content: "服务器请求出错，请稍后重试或刷新页面", duration: 2e3, type: "error" })) }, t.send() } }) }, 5: function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = function (e) { var t = e.type, n = { toolbar: "no", directories: "no", status: "no", menubar: "no", scrollbars: "yes", resizable: "yes", width: 730, height: 350 }, a = void 0 != window.screenLeft ? window.screenLeft : screen.left, i = void 0 != window.screenTop ? window.screenTop : screen.top, o = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : screen.width, r = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : screen.height; n.left = o / 2 - n.width / 2 + a, n.top = r / 2 - n.height / 2 + i; for (var s = Object.keys(n), c = "", l = 0; l < s.length; l++) { var d = s[l] + "=" + n[s[l]]; l > 0 ? c += "," + d : c = d } var u = window.open("https://huaban.com/subsite/" + t + "/", "_blank", c); window.focus && u.focus(); var v = setInterval(function () { u.closed && (window.location.reload(), clearInterval(v)) }.bind(void 0), 1e3) }, i = function () { a({ type: "auth" }) }, o = function () { a({ type: "register" }) }, r = function () { window.location.href = "https://huaban.com/login/?next=" + window.location.href }, s = function () { window.location.href = "https://huaban.com/signup/?next=" + window.location.href }; t.loginRedirect = r, t.signupRedirect = s, t.loginBinding = function () { if (!window._user) { var e = document.querySelector("header .login-in"); if (e) { var t = document.querySelector("header .sign-up"); e.addEventListener("click", i), t.addEventListener("click", o); var n = document.querySelector(".plaster .infoText"); n && n.addEventListener("click", i) } var a = document.querySelector(".login-status .login-in"); if (a) { var c = document.querySelector(".login-status .sign-up"); a.addEventListener("click", r), c.addEventListener("click", s) } } }, t.logoutBinding = function (e) { for (var t = e.handleError, n = document.querySelectorAll(".LogoutBtn"), a = 0; a < n.length; a++) n[a].addEventListener("click", function () { $.ajax({ url: "/api/v1/me/logout", type: "GET", success: function (e, n, a) { e.status ? window.location.reload() : t && t() }, error: function (e, t, n) { } }) }, !1) }, t.openLoginRequest = i, t.openRegisterRequest = o }, 6: function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.getUrlParam = function (e) { var t = new RegExp("(^|&)" + e + "=([^&]*)(&|$)"), n = window.location.search.substr(1).match(t); return null != n ? n[2] : null }, t.lastPathname = function (e) { var t = e.split("/"); return t[t.length - 1] } }, 9: function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = function () { function e(e, t) { for (var n = 0; n < t.length; n++) { var a = t[n]; a.enumerable = a.enumerable || !1, a.configurable = !0, "value" in a && (a.writable = !0), Object.defineProperty(e, a.key, a) } } return function (t, n, a) { return n && e(t.prototype, n), a && e(t, a), t } }(), i = n(1).dom.htmlToElement, o = function () { function e(t) { !function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, e), this.props = t, this.handleLeave = this.handleLeave.bind(this) } return a(e, [{ key: "componentDidMount", value: function () { var e = this; this.tmpNode.addEventListener("animationend", function t() { e.tmpNode.classList.remove("move-up-enter"), e.tmpNode.classList.remove("move-up-enter-active"), e.tmpNode.removeEventListener("animationend", t) }), this.tmpNode.classList.add("move-up-enter"), this.tmpNode.classList.add("move-up-enter-active") } }, { key: "handleLeave", value: function (e) { var t = this.props.duration; e.addEventListener("click", function () { e.addEventListener("animationend", function () { e.parentNode.removeChild(e), e = null }), e.classList.add("move-up-leave"), e.classList.add("move-up-leave-active") }), setTimeout(function () { e && (e.addEventListener("animationend", function () { e.parentNode.removeChild(e), e = null }), e.classList.add("move-up-leave"), e.classList.add("move-up-leave-active")) }, t) } }, { key: "render", value: function () { var e = this.props, t = e.content, n = e.type, a = i("\n      <div class='message'>\n        <div class='message-content'>\n          <div class='message-custom-content message-" + n + "'>\n            <i class='icon response-" + n + "'></i>\n            <span>" + t + "</span>\n          </div>\n        </div>\n      </div>\n    "); this.tmpNode = a; var o = document.querySelector(".global-message span"); if (o) o.appendChild(a); else { var r = document.createElement("span"); r.appendChild(a); var s = document.createElement("div"); s.classList.add("global-message"), s.appendChild(r), document.body.appendChild(s) } return this.handleLeave(a), a } }]), e }(); t.default = o } });